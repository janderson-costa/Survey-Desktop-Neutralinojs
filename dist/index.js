(()=>{var qe={newFile:null,openFile:null,saveFile:null,closeWorkbook:null,showFileInfo:null},A=qe;var S={proxy:null,tempFileName:null,tempFilePath:null,srvConfig:null,srvFileName:null,srvFilePath:null,sheets:[],dataTables:[],state:{opened:!1,saved:!0}};function $e(t){S=t}Ie();function x(t,...e){let l=t,h=e,c=a(),p;return c;function m(){let y=a();return c.replaceWith(y),c=y,f(),y}function a(){let y=n(),L=s(y);return b(L),L}function n(){let y=l;return y.reduce((H,$,M)=>{if(H=o(H),$=o($),M==0)return $;let F=M-1,W=o(y[F]),O=/@[a-zA-Z0-9]*="$/,q=h[F],j=typeof q=="function";return u(q)?q=`<element>${F}</element>`:j&&(W.endsWith(">")||!O.test(W))&&(j=!1,q=`<function>${F}</function>`),(H+(j?F:q)+$).replaceAll('readonly="true"',"readonly").replaceAll('readonly="false"',"").replaceAll('disabled="true"',"disabled").replaceAll('disabled="false"',"").replaceAll('selected="true"',"selected").replaceAll('selected="false"',"").replaceAll('checked="true"',"checked").replaceAll('checked="false"',"")},"")}function s(y){let L=document.createElement("template");return L.innerHTML=y.trim(),L.content.firstElementChild}function b(y){y.querySelectorAll("element, function").forEach($=>{let M=$.textContent,F=h[M],W=typeof F=="function"?F():F,O=W instanceof Array?W:[W];O.length||O.push(""),O.forEach((q,j)=>{$.before(q),j==O.length-1&&$.remove()})}),H(y),Array.from(y.children).forEach($=>{H($),$.children.length&&b($)});function H($){d($),Array.from($.attributes).forEach(M=>{let F=M.name.toLowerCase(),W=h[M.value];if(F.startsWith("@on")){let O=F.substring(3);$.addEventListener(O,q=>{p=v(q.target),W({event:q,element:$,reload:m})}),$.removeAttribute(F)}if(F=="@show"){let O=typeof W=="function"?W():M.value=="true";$.classList[O?"remove":"add"]("html-hidden"),$.removeAttribute(F)}})}}function d(y){y.reload||(y.reload=m)}function f(){let y=r(p);if(!y)return;let L=y.tagName.toLowerCase(),H=y.type;y&&!(L=="textarea"||H.match(/text|number|password|email|url|search|tel/))&&y.focus()}function u(y){return y instanceof Element||y[0]instanceof Element}function o(y){return typeof y=="string"?y.replace(/\n|\t/g,""):""}function r(y){return y?document.evaluate(y,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue:null}function v(y){if(!(y instanceof Element))return null;let L=[];for(;y&&y.nodeType===Node.ELEMENT_NODE;){let H=1,$=y.previousElementSibling;for(;$;)$.nodeName===y.nodeName&&H++,$=$.previousElementSibling;let F=`${y.nodeName.toLowerCase()}[${H}]`;L.unshift(F),y=y.parentNode}return`/${L.join("/")}`}}function Ie(){document.querySelector("style#html-style")||document.querySelector("head").appendChild(x`
		<style id="html-style">
			.html-hidden {
				display: none;
			}

			.html-disabled {
				opacity: .6;
				-webkit-user-select: none;
				-moz-user-select: none;
				user-select: none;
				pointer-events: none;
			}
		</style>
	`)}var Me={trigger:null,items:[],position:"left",top:0,left:0,onShow:null,onHide:null},ie;window.addEventListener("resize",t=>{ie&&ce(ie)});function de(t){t={...Me,...t};let e,l="",h="",c={options:t,element:null,show:m,hide:a};return c;function p(){let n=document.createElement("div");return n.className="ctx-menu",n.innerHTML=`${t.items.map(s=>s.divider?'<div class="ctx-divider"></div>':`
					<div class="ctx-item">
						<div class="ctx-icon"></div>
						<div class="ctx-text">
							<div class="ctx-name">${s.name}</div>
							<div class="ctx-description">${s.description||""}</div>
						</div>
					</div>
				`).join("")}`,n.querySelectorAll(":scope > div").forEach((s,b)=>{let d=t.items[b],f=d.icon;s.data=d,d.element=s;let u=s.querySelector(".ctx-icon");f!=null&&f!=null?typeof f=="string"?u.innerHTML=f:f instanceof HTMLElement&&u.appendChild(f):u.style.display="none",d.divider==null&&s.addEventListener("click",o=>{a(),d.onClick&&d.onClick(o)})}),c.element=n,document.body.appendChild(n),n}function m(n={}){ce(e),n={...t,...n};let s=n.x||0,b=n.y||0;e=p(),l="ctx-menu-visible-left",h="ctx-menu-invisible-left",setTimeout(()=>{if(n.trigger){let d=n.trigger;s=d.offsetLeft,b=d.offsetTop+d.offsetHeight+1,n.position.includes("top")&&(b=d.offsetTop-e.offsetHeight-1),n.position.includes("right")&&(s=s-e.offsetWidth+d.offsetWidth-1)}s+e.offsetWidth>window.innerWidth&&(s=s-e.offsetWidth,l="ctx-menu-visible-right",h="ctx-menu-invisible-right"),b+e.offsetHeight-window.innerHeight>0&&(b=window.innerHeight-e.offsetHeight),e.className="ctx-menu",e.classList.add(l),e.style.left=n.left+s+"px",e.style.top=n.top+b+"px",n.onShow&&n.onShow(c)}),ie=e,window.addEventListener("click",a),window.addEventListener("keyup",a)}function a(n){e&&(n&&!(!n.target.closest(".ctx-menu")||n.key=="Escape")||(e.classList.remove(l),e.classList.add(h),t.onHide&&t.onHide(c),setTimeout(()=>ce(e),200),window.removeEventListener("click",a),window.removeEventListener("keyup",a)))}}function ce(t){t&&(t.remove(),t=null)}function V(t,e={width:10}){return x`
		<div class="Buttons flex items-center gap-2">
			${()=>t.filter(l=>!l.hidden).map(l=>l.divider?x`<div class="divider h-5.5"></div>`:x`<button type="button" class="button w-${e.width} h-10" title="${l.title||""}" @onClick="${h=>l.onClick(h)}">
						${l.icon||""}
						${l.name||""}
					</button>`)}
		</div>
	`}var ze={temp_folder_path:"D:/_dev/Survey/2.0/Survey-Desktop/neutralinojs/dist/temp",excel_api_path:"D:/_dev/Survey/2.0/Survey-Desktop/ExcelAPI/bin/Debug/net48/win-x86/ExcelAPI.exe",table_row_field_types:[{name:"",displayName:"Texto"},{name:"",displayName:"N\xFAmero"},{name:"",displayName:"E-mail"},{name:"",displayName:"Data"},{name:"",displayName:"Data/Hora"},{name:"",displayName:"Op\xE7\xE3o"},{name:"",displayName:"Op\xE7\xE3o M\xFAltipla"},{name:"",displayName:"Imagem"},{name:"",displayName:"Assinatura"}]},I=ze;var T=new je;function je(){this.generateGuid=t,this.mergeProps=e,this.getElementIndex=l,this.createRangeArray=h,this.isArrayOfHTMLElement=c,this.parseDimension=p,this.setElementAttr=a,this.setElementStyle=m;function t(){return"a"+("1000000-1000-4000-8000"+-1e11).replace(/[018]/g,s=>(s^crypto.getRandomValues(new Uint8Array(1))[0]&15>>s/4).toString(16))}function e(n,s){let b={...n};for(let d in s)s[d]instanceof Object&&!(s[d]instanceof Array)&&!(s[d]instanceof Function)&&!(s[d]instanceof HTMLElement)?b[d]=e(n[d]||{},s[d]):b[d]=s[d];return b}function l(n){return Array.from(n.parentElement.children).indexOf(n)}function h(n,s){let b=n<=s;return Array.from({length:Math.abs(s-n)+1},(d,f)=>b?n+f:n-f)}function c(n){return Array.isArray(n)?n.every(s=>s instanceof HTMLElement):!1}function p(n){return typeof n=="number"?`${n}px`:n||""}function m(n,s={}){a(n,s,"style")}function a(n,s={},b=""){n=n instanceof Array?n:[n],n.forEach(d=>{for(let f in s){let u=b?d[b]:d,o=s[f];if(b=="style"){let r="";f.match(/index|line|grid|order|tab|orphans|widows|columns|counter|opacity/i)||(o=typeof o=="number"?o+"px":o),o.match(/important/i)&&(o=o.substring(0,o.indexOf("!")-1).trim(),r="important"),r?u.setProperty(f,o,r):u[f]=o}else typeof u[f]>"u"?u.setAttribute(f,o):u[f]=o}})}}var ae=class{id=null;data=[];place=null;header={hidden:!1,disabled:!1};columns=null;rows={selectOnClick:!1,allowMultipleSelection:!0};cells=null;borders={table:{top:!1,bottom:!1,all:!1,radius:null},rows:!0,cells:!1};footer={hidden:!1,disabled:!1,content:null};width=null;height=null;style=null;checkbox=!1;sort=!1;resize=!1;disabled=!1;onAddRow=null;onSelectRows=null;onUnselectRows=null;onUpdateRow=null;onRemoveRows=null;onDoubleClickRow=null;onResizeColumn=null;onClickOut=null;onCopyClip=null;onScroll=null;onScrollEnd=null},Z=class{checkbox=!1;name=null;displayName=null;width=null;minWidth=null;resize=!1;hidden=!1;disabled=!1;style=null},Q=class{row=null;checkbox=!1;data=null;value=null;name=null;hidden=!1;disabled=!1;display=null;style=null};function ue(t,e){let l=c(),h={element:l,isHidden:e.hidden,isDisabled:e.disabled,options:e,show:m,checked:p,disable:a};return m(!e.hidden),a(e.disabled),h;function c(){let n=document.createElement("div");if(n.classList.add("dt-header-cell"),e.checkbox)n.classList.add("checkbox"),n.insertAdjacentHTML("afterbegin",`
				<label class="dt-row-checkbox">
					<input type="checkbox" />
				</label>
			`),n.querySelector("label").addEventListener("change",b=>{b.target.checked?t.selectRows():t.unselectRows(b)});else{n.dataset.name=e.name,n.insertAdjacentHTML("afterbegin",`
				<label class="name" title="${e.title||""}">${e.displayName}</label>
				<span class="controls">
					<i class="sort asc" title="Sort"></i>
					<div class="resizer"></div>
				</span>
			`);let s=n.querySelector(".sort");t.options.sort&&e.sort!=!1&&(n.classList.add("sortable"),n.addEventListener("click",()=>{if(t.header.isDisabled||h.isDisabled)return;t.header.cells.forEach(d=>d.element.classList.remove("sorted"));let b=s.getAttribute("ascendent")!="true";n.classList.add("sorted"),s.classList.toggle("asc",b),s.classList.toggle("desc",!b),s.setAttribute("ascendent",b),t.sort(e.name,b)})),(t.options.resize||e.resize)&&n.classList.add("resizable"),e.style&&T.setElementStyle(n,e.style)}return t.options.borders.cells&&n.classList.add("cell-border-right"),n}function p(n=!0){let s=l.querySelector(".dt-row-checkbox input");s&&(s.checked=n)}function m(n=!0){h.isHidden=!n,e.hidden=h.isHidden,l.classList.toggle("visible",n),l.classList.toggle("hidden",!n),t._setBorders()}function a(n=!0){h.isDisabled=n,l.dataset.disabled=n,Array.from(l.children).forEach(s=>s.classList.toggle("disabled",n))}}function Le(t){let e={element:null,cells:[],isHidden:!1,isDisabled:!1,cell:c,show:p,disable:m},l=h();return e;function h(){let a=document.createElement("div");if(a.classList.add("dt-header"),t.options.checkbox){let n=new Z;n.checkbox=!0,n.resize=!1;let s=ue(t,n);e.cells.push(s),a.appendChild(s.element)}for(let n in t.options.columns){let s=t.options.columns[n],b=T.mergeProps(new Z,s);b.name=n;let d=ue(t,b);e.cells.push(d),a.appendChild(d.element)}return e.element=a,a}function c(a){return typeof a=="number"?e.cells[a]:e.cells.find(s=>s.options.name==a)}function p(a=!0){e.isHidden=!a,l.classList.toggle("hidden",!a)}function m(a=!0){e.isDisabled=a,Array.from(l.children).forEach(n=>{n.classList.toggle("disabled",a)})}}function fe(t,e){let l=c(),h={element:l,isHidden:e.hidden,isDisabled:e.disabled,options:e,value:p,display:m,checked:s,show:a,showContent:n,disable:b};return a(!e.hidden),n(!e.hidden),m(p()),h;function c(){let d=document.createElement("div");if(d.classList.add("dt-body-row-cell"),e.checkbox){d.classList.add("checkbox"),d.insertAdjacentHTML("afterbegin",`
				<label class="dt-row-checkbox">
					<input type="checkbox"/>
				</label>
			`);let f=d.querySelector("label");f.addEventListener("click",u=>u.stopPropagation()),f.addEventListener("change",u=>{t.header.cells[0].checked(!1),e.row.select(u.target.checked,u)})}else{let f=e.value!=null?e.value:"",u=t.options.cells?t.options.cells[e.name]||{}:{};d.dataset.name=e.name,d.insertAdjacentHTML("afterbegin",`
				<div class="value-hidden">${f}</div>
				<div class="value-display">${f}</div>
			`),u.style&&T.setElementStyle(d,u.style)}return t.options.borders.cells&&d.classList.add("cell-border-right"),t.options.borders.rows&&d.classList.add("cell-border-bottom"),d}function p(d,f=!0){let u=l.querySelector(".value-hidden");if(u)if(d!=null)e.data[e.name]=d,u.textContent=d,f&&m(d);else return d=e.value!=null?e.value:u.textContent,d}function m(d){let f=l.querySelector(".value-display"),u=t.options.cells?t.options.cells[e.name]||{}:{};if(u.display){let o=u.display({row:e.row,item:e.data,value:d});f.innerHTML="",o instanceof HTMLElement?f.appendChild(o):T.isArrayOfHTMLElement(o)?o.forEach(r=>f.appendChild(r)):f.innerHTML=o}else f&&(f.innerHTML=d)}function a(d=!0){h.isHidden=!d,l.classList.toggle("visible",d),l.classList.toggle("hidden",!d)}function n(d=!0){h.isHidden=!d,Array.from(l.children).forEach(f=>{f.classList.toggle("hidden",!d)})}function s(d=!0){let f=l.querySelector(".dt-row-checkbox input");f&&(f.checked=d)}function b(d=!0){h.isDisabled=d,Array.from(l.children).forEach(f=>{f.classList.toggle("disabled",d)})}}function _e(t,e){let l={element:null,id:T.generateGuid(),cells:[],isSelected:!1,isHidden:!1,isDisabled:!1,_data:e.data||{},data:d,cell:m,index:a,show:n,disable:s,select:b,text:f,remove:u},h=c();return p(),l;function c(){let o=document.createElement("div");return o.id=l.id,o.classList.add("dt-body-row"),o.addEventListener("click",r=>{!t.options.checkbox&&t.options.rows.selectOnClick&&b(!0,r)}),o.addEventListener("dblclick",r=>{r.target.tagName=="INPUT"||r.target.tagName=="TEXTAREA"||t.options.rows.selectOnClick&&(window.getSelection&&window.getSelection().removeAllRanges(),t.options.onDoubleClickRow&&t.options.onDoubleClickRow({row:l,event:r}))}),o.classList.toggle("selectable",t.options.rows.selectOnClick),l.element=o,o}function p(){if(t.options.checkbox){let o=new Q;o.row=l,o.checkbox=!0,o.resize=!1;let r=fe(t,o);l.cells.push(r),h.appendChild(r.element)}for(let o in t.options.columns){let r=t.options.columns[o],v=T.mergeProps(new Q,r);v.row=l,v.name=o,v.data=l._data,v.value=l._data[o];let y=fe(t,v);l.cells.push(y),h.appendChild(y.element)}}function m(o){return typeof o=="number"?l.cells[o]:l.cells.find(v=>v.options.name==o)}function a(){return T.getElementIndex(h)}function n(o=!0){l.isHidden=!o,h.classList.toggle("hidden",!o)}function s(o=!0){l.isDisabled=o,h.classList.toggle("disabled",o)}function b(o=!0,r){if(r&&r.shiftKey&&window.getSelection&&window.getSelection().removeAllRanges(),t.options.checkbox)l.isSelected=o,t.options.onSelectRows&&t.options.onSelectRows({rows:t.selectedRows()});else{if((!t.options.rows.allowMultipleSelection||!r||!r.ctrlKey&&!r.shiftKey)&&(t.unselectRows(r,!1),t._lastRowSelected=null),r&&r.ctrlKey&&(o=!l.isSelected),r&&r.shiftKey&&t._lastRowSelected){let v=T.createRangeArray(T.getElementIndex(t._lastRowSelected),T.getElementIndex(h));t.selectRows(v)}l.isSelected=o,(!r||!r.shiftKey)&&(t._lastRowSelected=h),h.classList.toggle("selected",o),t.options.onSelectRows&&t.options.onSelectRows({rows:t.selectedRows()})}}function d(o,r=!1){if(o){for(let v in o){let y=o[v];l.cell(v).value(y)}t.options.onUpdateRow&&t.options.onUpdateRow({row:l,fields:o})}else return r?l._data:(({meta:v,...y})=>y)(l._data)}function f(o){let r=o?l.cells.filter(y=>!!o.find(L=>L==y.options.name)):l.cells,v=[];return r.forEach(y=>v.push(y.element.querySelector(".value-display").innerText.trim())),v}function u(){t.removeRows(l)}}function Te(t){let e=h(),l={element:e,isHidden:t.options.footer.hidden,isDisabled:t.options.footer.disabled,show:p,disable:m,content:c};return c(t.options.footer.content),p(!l.isHidden),m(l.isDisabled),l;function h(){let a=document.createElement("div");return a.classList.add("dt-footer"),a}function c(a){a&&(typeof a=="string"?e.innerHTML=a:a instanceof HTMLElement&&e.appendChild(a))}function p(a=!0){l.isHidden=!a,e.classList.toggle("hidden",!a)}function m(a=!0){l.isDisabled=a,e.classList.toggle("disabled",a)}}function Ne(t){let e={options:t,id:t.id||T.generateGuid(),element:null,elements:{scrollable:null},header:null,body:{element:null},_columnWidths:null,rows:[],_lastRowSelected:null,footer:null,isDisabled:!1,_data:t.data||[],data:d,append:u,load:f,reload:o,width:s,height:b,column:n,addRow:v,selectedRows:y,selectRows:H,unselectRows:$,rowsByFieldValue:L,moveSelectedRows:M,removeRows:F,removeSelectedRows:W,removeUnselectedRows:O,sort:q,disable:j,clear:r,export:De,_setBorders:te},l=c(),h=`${e.id}-widths`;return p(),m(),a(),s(t.width),b(t.height),j(t.disabled),f(t.data),e;function c(){let i=document.createElement("div");i.id=e.id,i.classList.add("dt");let C=document.createElement("div");if(C.classList.add("scrollable"),i.appendChild(C),C.addEventListener("scroll",g=>{let w=g.target,E=Math.ceil(w.scrollTop+w.clientHeight)>=w.scrollHeight-1;E&&!w.alreadyAtBottom?(w.alreadyAtBottom=!0,t.onScrollEnd&&t.onScrollEnd({event:g,end:!0})):E||(w.alreadyAtBottom=!1)}),t.borders.table.all){if(i.classList.add("table-border-all"),t.borders.table.radius!=null){let g=t.borders.table.radius;i.style.borderRadius=T.parseDimension(g),C.style.borderRadius=T.parseDimension(g)}}else t.borders.table.top&&i.classList.add("table-border-top"),t.borders.table.bottom&&i.classList.add("table-border-bottom");return t.style&&T.setElementStyle(i,t.style),e.element=i,e.elements.scrollable=C,i}function p(){let i=Le(e);e.header=i,l.querySelector(".scrollable").appendChild(i.element),i.show(!t.header.hidden),i.disable(t.header.disabled)}function m(){let i=document.createElement("div");i.classList.add("dt-body"),e.body.element=i,l.querySelector(".scrollable").appendChild(i)}function a(){if(t.footer){let i=Te(e);e.footer=i,l.appendChild(i.element)}}function n(i){return{show:C,disable:g};function C(w=!0){e.header.cell(i).show(w),e.rows.forEach(E=>E.cell(i).show(w)),we()}function g(w=!0){e.header.cell(i).disable(w),e.rows.forEach(E=>E.cell(i).disable(w))}}function s(i){if(i==null)return l.clientWidth;l.style.width=T.parseDimension(i)||"auto"}function b(i){if(i==null)return l.clientHeight;l.style.height=T.parseDimension(i)||"auto"}function d(i,C=!1){if(i=i||e._data,i.length)for(let g in t.columns)i.forEach(w=>{w.hasOwnProperty(g)||(w[g]="")});return e._data=i,C?e._data:e._data.map(({meta:g,...w})=>w)}function f(i){r(!!i),d(i,!0).forEach(C=>v(C,!1,!1)),we(),He(),te(),e.elements.scrollable.scrollTop=0}function u(i){d([...e._data,...i],!0),i.forEach(C=>v(C,!1,!1)),te()}function o(){f()}function r(i=!0){i&&d([]),e.rows=[],e.body.element.innerHTML="",e.header.cells[0].checked(!1)}function v(i,C=!0,g=!0){let w=_e(e,{data:i});return e.rows.push(w),e.body.element.appendChild(w.element),i.meta={row:{id:w.id}},C&&e._data.push(i),g&&te(),t.onAddRow&&t.onAddRow({row:w}),w}function y(){return e.rows.filter(i=>i.isSelected)}function L(i,C){if(!(i==null||C==null))return e.rows.filter(g=>g._data[i]==C)}function H(i){i&&(i=i instanceof Array?i:[i]),e.rows.forEach(C=>{let g=!1;if(i){for(let w=0;w<i.length;w++)if(T.getElementIndex(C.element)==i[w]){g=!0;break}}else g=!0;C.isSelected=g,t.checkbox?C.cells[0].checked(g):C.element.classList.toggle("selected",g)}),t.checkbox&&e.header.cells[0].checked(),t.onSelectRows&&t.onSelectRows({rows:y()})}function $(i,C=!0){e.header.cells[0].checked(!1),y().forEach(g=>{g.isSelected=!1,g.element.classList.remove("selected"),g.cells[0].checked(!1)}),t.onUnselectRows&&C&&t.onUnselectRows({event:i})}function M(i=!0){if(t.sort)return;if(i)for(let g=e.rows.length-1;g>=0;g--){let w=g,E=g+1;if(e.rows[g].isSelected)if(E<e.rows.length)C(w,E);else break}else for(let g=0;g<e.rows.length;g++){let w=g,E=g-1;if(e.rows[g].isSelected)if(E>=0)C(w,E);else break}e.rows.forEach(g=>e.body.element.appendChild(g.element));function C(g,w){let E=e.rows.splice(g,1)[0],_=e._data.splice(g,1)[0];e.rows.splice(w,0,E),e._data.splice(w,0,_)}}function F(i){i=i instanceof Array?i:[i],i.length&&(i.forEach(C=>{e.rows.forEach((g,w)=>{g.id==C.id&&e.rows.splice(w,1)}),e._data.forEach((g,w)=>{g.meta.row.id==C.id&&e._data.splice(w,1)}),C.element.remove()}),t.onRemoveRows&&t.onRemoveRows())}function W(){F(y()),e.header.cells[0].checked(!1)}function O(){F(e.rows.filter(i=>!i.isSelected))}function q(i,C=!0){e.rows.sort((g,w)=>{let E=g.cell(i).value(),_=w.cell(i).value();return typeof E=="string"&&(E=String(E).toLowerCase(),_=String(_).toLowerCase()),E<_?C?-1:1:E>_?C?1:-1:0}),e.rows.forEach(g=>e.body.element.appendChild(g.element))}function j(i=!0){e.isDisabled=i,l.classList.toggle("disabled",i)}function De(i,C={separator:"	"}){return(i||e.selectedRows()).map(w=>{let E=w.cells.filter(_=>!_.checkbox&&!_.isHidden).map(_=>_.options.name);return w.text(E).join(C.separator)}).join(`
`)}function we(){let i=xe()||e._columnWidths;if(!i){i=[],t.checkbox&&i.push("34px");for(let C in t.columns){let g=t.columns[C];if(g.hidden)continue;let w=g.width,E=g.minWidth,_;!w&&!E?_="1fr":w==E?_=w+"px":(w=w?w+"px":"1fr",E=E?E+"px":w,_=`minmax(${E}, ${w})`),i.push(_)}}e._columnWidths=i,e.header.element.style.gridTemplateColumns=i.join(" "),e.body.element.style.gridTemplateColumns=i.join(" ")}function He(){let i=e.header.element,C=i.querySelectorAll(".dt-header-cell:not(.hidden)"),g=e.body.element,w=null,E,_,Se,Ce,ne,le=!1;if(i.hasResizeHandler)return;C.forEach((B,z)=>{let J=B.querySelector(".resizer");J&&(J.addEventListener("mousedown",se=>We(se,z,B)),J.addEventListener("click",se=>se.stopPropagation()))}),i.hasResizeHandler=!0;function We(B,z,J){document.addEventListener("mousemove",ke),document.addEventListener("mouseup",Ee),w=e.header.cell(J.dataset.name),!(!t.resize&&!w.options.resize)&&(i.classList.add("resizing"),le=!0,E=z,Se=B.pageX,_=getComputedStyle(i).gridTemplateColumns.split(" "),Ce=parseFloat(_[E]),document.body.style.cursor="e-resize",document.body.style.userSelect="none")}function ke(B){if(!le)return;ne=B.pageX-Se;let z=w.options.minWidth||50,J=Math.max(z,Ce+ne);Oe(E,J)}function Oe(B,z){z=typeof z=="number"?z+"px":z,_=getComputedStyle(i).gridTemplateColumns.split(" "),_[B]=z,i.style.gridTemplateColumns=_.join(" "),g.style.gridTemplateColumns=_.join(" "),e._columnWidths=_}function Ee(){document.removeEventListener("mousemove",ke),document.removeEventListener("mouseup",Ee),le&&(le=!1,i.classList.remove("resizing"),document.body.style.cursor="",document.body.style.userSelect="",xe(e._columnWidths),ne&&t.onResizeColumn&&(t.onResizeColumn({column:w,widths:e._columnWidths}),ne=0))}}function xe(i){if(i)i[i.length-1]=`minmax(${i[i.length-1]}, 1fr)`,localStorage.setItem(h,JSON.stringify(i));else return i=localStorage.getItem(h),i&&(e._columnWidths=JSON.parse(i)),e._columnWidths}function te(){if(!(d().length&&e.header&&e.body))return;e.header.element.querySelector(".visible:last-child").classList.remove("cell-border-right"),e.body.element.childNodes.forEach((C,g)=>{C.querySelector(".visible:last-child").classList.remove("cell-border-right")});let i=t.footer.hidden?"inherit":"0px";e.elements.scrollable.style.borderBottomLeftRadius=i,e.elements.scrollable.style.borderbottomRightRadius=i}}function Fe(t){t=T.mergeProps(new ae,t);let e=Ne(t);return t.place&&t.place.appendChild(e.element),e.element.addEventListener("click",l),e.element.addEventListener("keydown",h),e.destroy=c,e;function l(p){if(!e.isDisabled&&!p.target.closest(".dt-header")&&!p.target.closest(".dt-body")){let m=!1;t.onClickOut&&(m=!t.onClickOut({event:p})),!t.checkbox&&!m&&e.unselectRows(p)}}function h(p){p.ctrlKey&&p.key=="a"&&(t.rows.selectOnClick&&t.rows.allowMultipleSelection||t.checkbox)&&(p.preventDefault(),e.selectRows()),t.onCopyClip&&p.ctrlKey&&p.key=="c"&&(t.rows.selectOnClick||t.checkbox)&&t.onCopyClip({text:e.export()}),p.key=="Escape"&&e.unselectRows(p)}function c(){e.element.removeEventListener("click",l),e.element.removeEventListener("keydown",h),e.element.remove()}}function K(){return{pause:t,form:e,observe:l,css:h};function t(c=1e3){return new Promise(p=>setTimeout(p,c))}function e(){return{field:c};function c(){return{autoHeight:p};function p(m){setTimeout(()=>{m.style.height="auto",m.style.height=m.scrollHeight+"px"},100)}}}function l(c,{onChange:p,onDelete:m=null}){return typeof c!="object"||c===null?c:new Proxy(c,{get(a,n,s){let b=Reflect.get(a,n,s);return typeof b=="object"&&b!==null?l(b,{onChange:p,onDelete:m}):b},set(a,n,s,b){let d=a[n],f=Reflect.set(a,n,s,b);return f&&d!==s&&p&&p({target:a,prop:n,value:s}),f},deleteProperty(a,n){let s=Reflect.deleteProperty(a,n);return s&&m&&m({target:a,prop:n}),s}})}function h(c,p={}){let m=new Set(["borderBottomLeftRadius","borderBottomRightRadius","borderBottomWidth","borderLeftWidth","borderRadius","borderRightWidth","borderTopLeftRadius","borderTopRightRadius","borderTopWidth","borderWidth","bottom","columnGap","fontSize","gap","height","left","letterSpacing","lineHeight","margin","marginBottom","marginLeft","marginRight","marginTop","maxHeight","maxWidth","minHeight","minWidth","outlineWidth","padding","paddingBottom","paddingLeft","paddingRight","paddingTop","right","rowGap","top","translateX","translateY","translateZ","width"]),a={};for(let[n,s]of Object.entries(p))m.has(n)&&typeof s=="number"?a[n]=`${s}px`:a[n]=s;Object.assign(c.style,a)}}var P=(t,e={})=>{let h={add:()=>x`<i class="icon" data-lucide="plus"></i>`,addGroup:()=>x`<i class="icon" data-lucide="circle-plus"></i>`,new:()=>x`<i class="icon" data-lucide="file-plus-2"></i>`,open:()=>x`<i class="icon" data-lucide="folder-open"></i>`,edit:()=>x`<i class="icon" data-lucide="pencil"></i>`,save:()=>x`<i class="icon" data-lucide="save"></i>`,load:()=>x`<i class="icon" data-lucide="import"></i>`,close:()=>x`<i class="icon" data-lucide="x"></i>`,clear:()=>x`<i class="icon" data-lucide="brush-cleaning"></i>`,send:()=>x`<i class="icon" data-lucide="send-horizontal"></i>`,smartphone:()=>x`<i class="icon" data-lucide="smartphone"></i>`,arrowUp:()=>x`<i class="icon" data-lucide="arrow-up"></i>`,arrowDown:()=>x`<i class="icon" data-lucide="arrow-down"></i>`,up:()=>x`<i class="icon" data-lucide="chevron-up"></i>`,down:()=>x`<i class="icon" data-lucide="chevron-down"></i>`,refresh:()=>x`<i class="icon" data-lucide="refresh-cw"></i>`,info:()=>x`<i class="icon" data-lucide="info"></i>`,ellipsisVertical:()=>x`<i class="icon" data-lucide="ellipsis-vertical"></i>`,remove:()=>x`<i class="icon" data-lucide="trash-2"></i>`,inputText:()=>x`<i class="icon" data-lucide="text-cursor-input"></i>`,table:()=>x`<i class="icon" data-lucide="table"></i>`,check:()=>x`<i class="icon" data-lucide="check"></i>`,gridPlus:()=>x`<i class="icon" data-lucide="grid-2x2-plus"></i>`}[t]();return e.class&&e.class.forEach(c=>h.classList.add(c)),h},G=()=>lucide.createIcons();var Be={name:{displayName:"Nome do campo",minWidth:150},description:{displayName:"Descri\xE7\xE3o",minWidth:150},value:{displayName:"Valor"},type:{displayName:"Tipo",width:150},required:{displayName:"Obrigat\xF3rio",width:90},readonly:{displayName:"Edit\xE1vel",minWidth:90}};function Re(t){return Fe({id:t.srvTable.id,data:[],place:null,checkbox:!1,sort:!1,resize:!0,height:"100%",columns:Be,borders:{table:{all:!0,radius:6},rows:!0,cells:!0},footer:{hidden:!0},rows:{selectOnClick:!0},cells:{name:{display:({row:e,item:l,value:h})=>x`
						<input type="text" value="${h}" @onChange="${c=>{l.name=c.element.value.trim()}}"/>
					`},description:{display:({row:e,item:l,value:h})=>{let c=x`
						<textarea rows="1" @onChange="${p=>{l.description=p.element.value.trim()}}" @onInput="${p=>{K().form().field().autoHeight(p.element)}}">${h}</textarea>
					`;return K().form().field().autoHeight(c),c}},type:{display:({row:e,item:l,value:h})=>{let c=x`
						<select @onChange="${p=>{l.type=p.element.value}}">${I.table_row_field_types.map(p=>`
							<option value="${p.displayName}">${p.displayName}</option>
						`)}</select>
					`;return c.value=h,c}},value:{display:({row:e,item:l,value:h})=>{if(l.type=="Texto"){let c=x`
							<textarea rows="1" @onChange="${p=>{l.value=p.element.value}}" @onInput="${p=>{K().form().field().autoHeight(p.element)}}">${l.value}</textarea>
						`;return K().form().field().autoHeight(c),c}else{if(l.type=="N\xFAmero")return x`
							<input type="number" value="${l.value}" @onChange="${c=>{l.value=c.element.value}}"/>
						`;if(l.type=="E-mail")return x`
							<input type="email" value="${l.value}" @onChange="${c=>{l.value=c.element.value}}"/>
						`;if(l.type=="Data")return x`
							<input type="date" value="${l.value}" @onChange="${c=>{l.value=c.element.value}}"/>
						`;if(l.type=="Data/Hora")return x`
							<input type="datetime-local" value="${l.value}" @onChange="${c=>{l.value=c.element.value}}"/>
						`;if(l.type=="Hor\xE1rio")return x`
							<input type="time" value="${l.value}" @onChange="${c=>{l.value=c.element.value}}"/>
						`;if(l.type=="Op\xE7\xE3o"){let c=x`
							<select @onChange="${p=>{l.value=p.element.value}}">${I.table_row_field_types.map(p=>`
								<option value="${p.displayName}">${p.displayName}</option>
							`)}</select>
						`;return c.value=h,c}else l.type=="Opc\xE3o M\xFAltipla"||l.type=="Imagem"||l.type=="Assinatura"}return x`
						<input type="text" value="${l.value}" @onChange="${c=>{l.value=c.element.value}}"/>
					`}},required:{display:({row:e,item:l,value:h})=>x`
						<label class="flex items-center justify-center w-[80px] h-[32px] px-1.5 opacity-90">
							<input type="checkbox" checked="${()=>l.required}" @onChange="${c=>{l.required=c.element.checked}}" class="scale-[1.1]"/>
						</label>
					`},readonly:{display:({row:e,item:l,value:h})=>x`
						<label class="flex items-center justify-center w-[56px] h-[32px] px-1.5 opacity-90">
							<input type="checkbox" checked="${()=>l.readonly}" @onChange="${c=>{l.readonly=c.element.checked}}" class="scale-[1.1]"/>
						</label>
					`}},onSelectRows:({rows:e})=>{k.table_buttons=k.table_buttons.reload(),G()},onUnselectRows:()=>{k.table_buttons=k.table_buttons.reload(),G()},onClickOut:({event:e})=>!1})}function Pe(t){let e=t.srvConfig,l=de({items:[]}),h=[{title:"Novo",icon:P("new"),onClick:()=>A.newFile()},{title:"Abrir",icon:P("open"),onClick:()=>A.openFile()},{title:"Salvar",icon:P("save"),onClick:()=>A.saveFile()},{title:"Informa\xE7\xF5es do arquivo",icon:P("info"),onClick:()=>A.showFileInfo()},{divider:!0,hidden:!1},{title:"Carregar dados nas planilhas",icon:P("load"),onClick:()=>console.log("onClick")},{title:"Limpar dados das planilhas",icon:P("clear"),onClick:()=>console.log("onClick")},{title:"Enviar por E-mail",icon:P("send"),onClick:()=>console.log("onClick")}],c=[{title:"Visualizar no dispositivo m\xF3vel",icon:P("smartphone"),onClick:()=>console.log("onClick")}],p=[{divider:!0,hidden:!1},{title:"Adicionar grupo",icon:P("addGroup"),onClick:()=>console.log("onClick")},{title:"Adicionar item",icon:P("add"),onClick:()=>console.log("onClick")},{title:"Mover item selecionado para cima",icon:P("arrowUp"),onClick:()=>console.log("onClick")},{title:"Mover item selecionado para baixo",icon:P("arrowDown"),onClick:()=>console.log("onClick")},{title:"Excluir item selecionado",icon:P("close"),onClick:()=>console.log("onClick")}],m=x`<div>${()=>(h.forEach((o,r)=>{!t.state.opened&&r>1&&(o.hidden=!0)}),V(h))}</div>`,a=V(c),n=x`
		<div class="tabs flex gap-2">${()=>e.data.tables.filter(o=>o.enabled).map((o,r)=>{let v=x`
					<button type="button" class="tab button h-10 px-3 whitespace-nowrap" id="${o.id}" @onClick="${()=>pe(o)}">
						<span>${o.name}</span>
					</button>
				`;return k.activeDataTable?k.activeDataTable.id==o.id&&v.classList.add("active"):r==0&&v.classList.add("active"),v})}</div>
	`,s=x`
		<button type="button" class="button add-sheet min-w-10 h-10" title="Adicionar planilha" @onClick="${async o=>{o.event.stopPropagation(),S.sheets.length&&(l.options.items=S.sheets.map((r,v)=>{let y=e.data.tables.find(L=>L.id==r.Id);if(y)return{icon:y.enabled?P("check"):"",name:r.Name,onClick:()=>me(e,y,v)}}),l.show({trigger:o.element.closest("button"),position:"bottom left"}),G())}}">${P("gridPlus")}</button>
	`,b=x`<div>${()=>(p.forEach((o,r)=>{r>2&&(o.hidden=!0,k.activeDataTable&&k.activeDataTable.rows.some(v=>v.isSelected)&&(o.hidden=!1))}),V(p))}</div>`,d=e.data.tables.map(o=>{let r=Re({srvTable:o});return S.dataTables.push(r),r.element}),f=x`<span class="flex items-center h-10">${()=>{let o=0;return n.querySelectorAll(".tab").forEach((r,v)=>{r.classList.contains("active")&&(o=S.dataTables[v].rows.length)}),o?`${o} item(s)`:""}}</span>`,u=x`
		<div class="layout flex h-screen">
			<div class="flex flex-col justify-between w-screen h-screen">
				<div>
					<!-- toolbar-actions -->
					<div class="toolbar-actions flex justify-between gap-4 px-4 py-4">
						<div class="left">${m}</div>
						<div class="right" @show="${t.state.opened}">${a}</div>
					</div>

					<!-- toolbar-table -->
					<div class="toolbar-table flex gap-2 px-4 pb-4" @show="${t.state.opened}">
						<div class="flex gap-2 w-max-[600px] overflow-x-auto">${n}</div>
						${s}
						${b}
					</div>
				</div>

				<!-- tables -->
				<div class="tables flex-1 overflow-auto px-4">${d}</div>

				<!-- footer -->
				<div class="footer flex gap-4 px-4 py-4">${f}</div>
			</div>

			<!-- app viewer -->
			<div></div>
		</div>
	`;k.layout=u,k.actions_left_buttons=m,k.actions_right_buttons=a,k.table_buttons=b,k.table_tabs=n,k.tables=u.querySelector(".tables")}function Ae(t){t.srvConfig.data.tables.forEach((l,h)=>{S.dataTables[h].load(l.rows)})}function me(t,e,l){if(!(t.data.tables.filter(c=>c.enabled).length==1&&e.enabled)){if(e.enabled=!e.enabled,e.enabled)k.activeDataTable=S.dataTables[l];else{let c=t.data.tables,p=c.findIndex(m=>m.id==k.activeDataTable.id);c[p].enabled||(p=c.findIndex((m,a)=>a>l&&m.enabled),p==-1&&(p=c.reverse().findIndex((m,a)=>a<l&&m.enabled),c.reverse())),e=c[p],k.activeDataTable=S.dataTables[p]}k.table_tabs=k.table_tabs.reload(),k.selectTable(e)}}function pe(t){t=t||S.srvConfig.data.tables[0],k.activeDataTable=S.dataTables.find(e=>e.id==t.id),k.table_tabs=k.table_tabs.reload(),S.dataTables.forEach((e,l)=>{e.element.classList.add("!hidden"),e.id==t.id&&e.element.classList.remove("!hidden")}),k.table_buttons=k.table_buttons.reload(),G(),k.footerTotal=k.footerTotal.reload()}var Ge={layout:null,actions_left_buttons:null,actions_right_buttons:null,table_buttons:null,table_tabs:null,tables:null,activeDataTable:null,footerTotal:null,create:Pe,loadTables:Ae,addTable:me,selectTable:pe},k=Ge;function ee(){return{versions:{desktop:null,mobile:null},data:{tables:[]},info:he()}}function oe(){return{id:"",name:"",enabled:!0,rows:[re()]}}function re(){return{id:"",name:"",description:"",type:"",subtype:"",value:"",objects:"",required:!1,readonly:!1,isGroup:!1}}function he(){return{createdAt:"",createdBy:"",createdByEmail:""}}var Ue={title:"",content:"",width:360,hideOut:!0,buttons:null};function Y(t){t={...Ue,...t};let e=!1,l,h,c={options:t,show:m,hide:a,block:n,showSpin:s};return c;function p(){let f=document.createElement("div");f.className="modal-overlay",f.innerHTML=`
			<div class="modal">
				<div class="modal-title">
					<span>${t.title}</span>
					<span class="modal-spin"></span>
				</div>
				<div class="modal-content"></div>
				<div class="modal-buttons"></div>
			</div>
		`;let u=f.querySelector(".modal"),o=f.querySelector(".modal-content");return f.addEventListener("click",()=>{t.hideOut&&a()}),u.addEventListener("click",r=>r.stopPropagation()),t.width&&(u.style.width=t.width+"px"),t.content instanceof HTMLElement?o.appendChild(t.content):o.innerHTML=t.content,t.buttons=t.buttons||[],h=f.querySelector(".modal-buttons"),t.buttons.forEach(r=>{let v=document.createElement("button");v.type="button",v.innerHTML=r.name,v.classList.toggle("primary",!!r.primary),r.element=v,r.onClick&&v.addEventListener("click",()=>r.onClick(c)),h.appendChild(v)}),f}function m(){l=p(),document.body.appendChild(l),l.classList.remove("modal-invisible"),l.classList.add("modal-visible"),window.addEventListener("keydown",d),t.buttons.forEach(f=>{f.focused&&f.element.focus()})}function a(){b()}function n(f=!0){t.buttons&&(e=f,h.querySelectorAll("button").forEach(u=>{u.blur(),u.classList.toggle("disabled",f)}))}function s(f=!0){l.querySelector(".modal-spin").classList.toggle("visible",f)}function b(){e||(l.classList.remove("modal-visible"),l.classList.add("modal-invisible"),setTimeout(()=>{l.remove(),window.removeEventListener("keydown",d)},200))}function d(f){f.key=="Tab"&&e&&f.preventDefault(),f.key=="Escape"&&b()}}function D(){return{data:null,error:null,canceled:!1}}var N=Je();function Je(){return{setWindowTitle:t,setOnWindowClose:e,setMenubar:l,showFileDialog:h,readFile:c,writeFile:p,renameFile:m,copyFile:a,openFile:n,clearFolder:s,zipFile:b,unzipFile:d,storage:f};async function t(u={saved:null}){let o=await Neutralino.app.getConfig(),r=o.name,v=o.version,y=u.saved==!0||S.state.saved;return Neutralino.window.setTitle(`${r} - ${v} ${y?"":"*"}`)}async function e(){return Neutralino.events.on("windowClose",async()=>{S.state.saved?await u():typeof await A.saveFile(!0)=="boolean"&&await u()});async function u(){let o=await A.closeWorkbook();if(o.error){Y({title:"Survey",content:`N\xE3o foi poss\xEDvel fechar o arquivo temp.xls(x)<br>${o.error}`,buttons:[{name:"OK",onClick:async r=>{r.hide()}}]}).show();return}await f("appData",null),await Neutralino.app.exit()}}function l(){}async function h(u={title:"",target:"",filters:[]}){let o={title:"Abrir",target:"open",filters:[{name:"Survey",extensions:["srv"]}]},r=D(),v;return u={...o,...u},u.target=="open"?v=await Neutralino.os.showOpenDialog(u.title,{filters:u.filters,multiSelections:!1}):u.target=="save"?v=await Neutralino.os.showSaveDialog(u.title,{filters:u.filters}):u.target=="folder"&&(v=await Neutralino.os.showFolderDialog(u.title)),r.canceled=!v.length,v.length&&(r.data=v),r}async function c(u={filePath:""}){let o=D();return Neutralino.filesystem.readFile(u.filePath).then(r=>o.data=r).catch(r=>o.error=r.message).then(()=>o)}async function p(u={filePath:"",data:""}){let o=D();return Neutralino.filesystem.writeFile(u.filePath,u.data).then(r=>{r.success||(o.error=r.message)}).catch(r=>{o.error=r.message}).then(()=>o)}async function m(u={filePath:"",name:""}){let o=u.filePath.substring(0,u.filePath.lastIndexOf("/")),r=u.filePath.substring(u.filePath.lastIndexOf(".")),v=o+u.name+r,y=D();return Neutralino.filesystem.move(u.filePath,v).then(L=>{L.success||(y.error=L.message)}).catch(L=>{y.error=L.message}).then(()=>y)}async function a(u={fromFilePath:"",toFilePath:""}){let o=D();return Neutralino.filesystem.copy(u.fromFilePath,u.toFilePath).then(r=>{r.success||(o.error=r.message)}).catch(r=>{o.error=r.message}).then(()=>o)}async function n(u={filePath:""}){let o=D();return Neutralino.os.open(u.filePath).then(r=>{r.success||(o.error=r.message)}).catch(r=>{o.error=r.message}).then(()=>o)}async function s(u={folderPath:""}){let o=D();return await Neutralino.filesystem.remove(u.folderPath).then(r=>{r.success||(o.error=r.message)}).catch(r=>{o.error=r.message}),await Neutralino.filesystem.createDirectory(u.folderPath).then(r=>{r.success||(o.error=r.message)}).catch(r=>{o.error=r.message}),o}async function b(u={fromFolderPath:"",toFilePath:""}){let o=D();return Neutralino.os.execCommand(`.\\dist\\tools\\7zip\\7za.exe a -tzip -sccUTF-8 "${u.toFilePath}" "${u.fromFolderPath}/*" -y`,{background:!1}).then(r=>{r.stdErr&&(o.error=r.stdErr)}).catch(r=>{o.error=r.message}).then(()=>o)}async function d(u={fromFilePath:"",toFolderPath:""}){let o=D();return Neutralino.os.execCommand(`.\\dist\\tools\\7zip\\7za.exe x -sccUTF-8 "${u.fromFilePath}" -o"${u.toFolderPath}" -y`,{background:!1}).then(async r=>{r.stdErr?o.error=r.stdErr:await Neutralino.os.execCommand(`cmd /c dir "${u.toFolderPath}" /b /a-d`).then(v=>{let y=v.stdOut.split(/\r?\n/).filter(Boolean);o.data=y}).catch(v=>{o.error=v.message})}).catch(r=>{o.error=r.message}).then(()=>o)}async function f(u,o){return typeof o>"u"?Neutralino.storage.getData(u).then(r=>{if(!r.message)return r!=""?JSON.parse(r):r}).catch(()=>null):(typeof o=="object"&&o!=null&&(o=JSON.stringify(o)),Neutralino.storage.setData(u,o).then(()=>!0).catch(()=>!1))}}var U=Ke();function Ke(){return{newFile:t,openFile:e,getSheets:c,saveFile:l,saveWorkbook:h,closeWorkbook:p};async function t(m={minimizeWindow:null}){let a=await N.showFileDialog({target:"open",title:"Novo",filters:[{name:"Excel",extensions:["xlsx","xls"]}]});if(a.canceled)return a;m.minimizeWindow&&m.minimizeWindow();let n=a.data[0],b="temp"+n.substring(n.lastIndexOf("."));return a=await N.clearFolder({folderPath:"./dist/temp"}),a.error||(S.tempFileName=b,a=await N.copyFile({fromFilePath:n,toFilePath:"./dist/temp/"+b}),a.error)||(a=await N.openFile({filePath:`${I.temp_folder_path}/${b}`}),a.error)?a:new Promise(d=>{let f=setInterval(async()=>{a=await c();let u=a.data||[];if(u.length){clearInterval(f);let o=ee();u.forEach((r,v)=>{let y=oe();y.id=r.Id,y.name=r.Name,y.enabled=v==0,o.data.tables.push(y)}),a=await N.writeFile({filePath:"./dist/temp/config.json",data:JSON.stringify(o)}),a.error||(a.data=o),d(a)}},1e3)})}async function e(m){let a=m.substring(m.lastIndexOf("/")+1),n=ee();S.srvFilePath=m,S.srvFileName=a;let s=await N.clearFolder({folderPath:"./dist/temp"});if(s.error||(s=await N.unzipFile({fromFilePath:m,toFolderPath:"./dist/temp"}),s.error))return s;let b=s.data.find(f=>f.startsWith("temp.xls"));if(!b){let f=s.data.find(o=>o.startsWith("spreadsheet"));if(b="temp"+f.substring(f.lastIndexOf(".")),s=await N.copyFile({fromFilePath:"./dist/temp/"+f,toFilePath:"./dist/temp/"+b}),s.error)return s}S.tempFileName=b;let d=await N.readFile({filePath:"./dist/temp/config.json"});if(d.data)n=JSON.parse(d.data);else{let f=await N.readFile({filePath:"./dist/temp/formdata.json"}),u=await N.readFile({filePath:"./dist/temp/report.json"});if(f.data){let o=JSON.parse(f.data);n.data=Ye(o)}if(u.data){let o=JSON.parse(u.data);n.info=Xe(o)}if(s=await N.writeFile({filePath:"./dist/temp/config.json",data:JSON.stringify(n)}),s.error)return s}return N.openFile({filePath:`${I.temp_folder_path}/${b}`}),new Promise(f=>{let u=setInterval(async()=>{s=await c();let o=s.data||[];o.length&&(clearInterval(u),o.forEach(r=>{let v=!0;if(n.data.tables.forEach(y=>{r.Name==y.name&&(y.id=r.Id,v=!1)}),v){let y=oe();y.id=r.Id,y.name=r.Name,y.enabled=!1,n.data.tables.push(y)}}),s.data=n,f(s))},1e3)})}async function l(m){let a=await N.writeFile({filePath:"./dist/temp/config.json",data:JSON.stringify(m)});if(a.error)return a;if(a=await h(),a.data){let s=S.srvFilePath;a=await N.zipFile({fromFolderPath:"./dist/temp",toFilePath:s})}return a}async function h(){let m=S.tempFileName,a=D();return m?Neutralino.os.execCommand(`${I.excel_api_path} workbookPath=${I.temp_folder_path}/${m} method=SaveWorkbook`,{background:!1}).then(n=>{n.stdErr?a.error=n.stdErr:n.stdOut&&(a.data=JSON.parse(n.stdOut).Data)}).catch(n=>{a.error=n.message}).then(()=>a):a}async function c(){let m=S.tempFileName,a=D();return m?Neutralino.os.execCommand(`${I.excel_api_path} workbookPath=${I.temp_folder_path}/${m} method=GetSheets`,{background:!1}).then(n=>{n.stdErr?a.error=n.stdErr:n.stdOut&&(a.data=JSON.parse(n.stdOut).Data)}).catch(n=>{a.error=n.message}).then(()=>a):a}async function p(){let m=S.tempFileName,a=D();return m?Neutralino.os.execCommand(`${I.excel_api_path} workbookPath=${I.temp_folder_path}/${m} method=CloseWorkbook`,{background:!1}).then(n=>{n.stdErr?a.error=n.stdErr:n.stdOut&&(a.data=JSON.parse(n.stdOut).Data)}).catch(n=>{a.error=n.message}).then(()=>a):a}}function Ye(t){let e=[...new Set(t.map(c=>c.Planilha))],l={tables:[]},h="";return e.forEach(c=>{let p=oe();p.name=c,p.rows=[],t.filter(m=>m.Planilha==c).forEach(m=>{if(m.Grupo&&m.Grupo!=h){h=m.Grupo;let n=re();n.isGroup=!0,n.name=m.Grupo,p.rows.push(n)}let a=re();a.id=m.Id,a.objects=JSON.parse(m.Objetos||"[]"),a.name=m.Nome,a.description=m.Descricao,a.type=m.Tipo,a.subtype=m.SubTipo,a.value=m.Valor,a.required=m.Obrigatorio=="1",a.readonly=m.Editavel!="1",p.rows.push(a)}),l.tables.push(p)}),l}function Xe(t){let e=he();return e.createdBy=t.author,e.createdByEmail=t.mailAuthor,e.createdAt=t.created,e}var Ve={icon:null,message:null,position:"bottom center",gap:12,inset:12,time:5,spin:!1,buttonClose:!1,onHide:null,onClose:null,onBeforeClose:null},R=document.querySelector(".toasts");R||(R=document.createElement("div"),R.className="toasts",R.addEventListener("mouseover",()=>R.classList.add("scrollable","mouseover")),R.addEventListener("mouseout",()=>R.classList.remove("scrollable","mouseover")),document.body.after(R));function X(t={}){t={...Ve,...t};let e,l;return R.style.inset=`${t.inset}px`,h(),{message:c,show:p,hide:m};function h(){e=document.createElement("div"),e.classList.add("toast-wrapper"),e.innerHTML=`
			<div class="toast">
				<div class="toast-icon"></div>
				<div class="toast-body">
					<div class="toast-content">
						${t.message}
					</div>
				</div>
				<div class="toast-controls">
					<div class="toast-button hidden">
						<button type="button" class="toast-button-icon" title="Fechar">\u2716</button>
					</div>
					<div class="toast-spin hidden"></div>
				</div>
			</div>
		`;let a=e.querySelector(".toast"),n=a.querySelector(".toast-icon"),s=a.querySelector(".toast-controls"),b=a.querySelector(".toast-button"),d=a.querySelector(".toast-spin");a.addEventListener("mouseover",()=>a.classList.add("mouseover")),a.addEventListener("mouseout",()=>a.classList.remove("mouseover")),e.prepend(a),t.icon&&(t.icon instanceof HTMLElement?n.appendChild(t.icon):n.innerHTML=t.icon,a.prepend(n)),t.buttonClose&&(b.classList.remove("hidden"),b.querySelector("button").addEventListener("click",async()=>{t.onBeforeClose?await t.onBeforeClose()&&m():m()})),t.spin&&(d.classList.remove("hidden"),b.classList.add("hidden")),s.addEventListener("mouseover",()=>{t.buttonClose&&t.spin&&(d.classList.add("hidden"),b.classList.remove("hidden"))}),s.addEventListener("mouseout",()=>{t.buttonClose&&t.spin&&(d.classList.remove("hidden"),b.classList.add("hidden"))})}function c(a){e.querySelector(".toast-content").innerHTML=a||""}function p(){let a="center";if(t.position.match("left")?a="left":t.position.match("right")&&(a="right"),e.classList.add(a),t.position.match("top")){R.querySelectorAll(".toast-wrapper.bottom").forEach(b=>b.remove()),e.classList.add("top"),e.style.transform="scale(0.8) translateY(-16px)",R.prepend(e);let n=e.offsetHeight;setTimeout(()=>{e.style.transform="scale(1)",e.style.transform="translateY(0px)",e.style.opacity=1},0),R.querySelectorAll(".toast-wrapper").forEach((b,d)=>{if(d==0)return;let f=Number(b.style.transform.replace(/\D/g,""));b.style.transform=`translateY(calc(${f+n}px + ${t.gap}px))`})}if(t.position.match("bottom")){R.querySelectorAll(".toast-wrapper.top").forEach(b=>b.remove()),e.classList.add("bottom"),e.style.transform="scale(0.8) translateY(16px)",R.appendChild(e);let n=e.offsetHeight;setTimeout(()=>{e.style.transform="scale(1)",e.style.transform="translateY(0px)",e.style.opacity=1},0);let s=R.querySelectorAll(".toast-wrapper");s.forEach((b,d)=>{if(d==s.length-1)return;let f=Number(b.style.transform.replace(/\D/g,""));b.style.transform=`translateY(calc(-1 * (${f+n}px + ${t.gap}px)))`})}l=setInterval(()=>{!t.buttonClose&&!t.spin&&!R.querySelectorAll(".toast.mouseover").length&&m()},t.time*1e3)}function m(){e.style.transform=`translateY(${e.style.transform})`,e.style.opacity=0;let a=t.position.match("top"),n=Array.from(R.querySelectorAll(".toast-wrapper")),s;n=a?n:n.reverse();for(let b of n){if(b==e){s=e.offsetHeight;continue}if(s){let d=Number(b.style.transform.replace(/\D/g,""));d=a?`${d-s-t.gap}px`:`calc(-1 * ${d-s-t.gap}px)`,b.style.transform=`translateY(${d})`}}setTimeout(()=>e.remove(),300),t.onHide&&t.onHide(),t.onClose&&t.onClose(),clearInterval(l)}}Neutralino.init();var be;A.newFile=ve;A.openFile=Ze;A.saveFile=ge;A.closeWorkbook=U.closeWorkbook;A.showFileInfo=Qe;N.setWindowTitle();N.setMenubar();N.setOnWindowClose();ye();async function ye(){let t=await N.storage("appData");t&&!S.proxy&&$e(t),S.srvConfig=S.srvConfig||ee(),S.dataTables=[],be=!1,S.proxy=K().observe(S,{onChange:async()=>{be&&(S.state.saved=!1,N.setWindowTitle(),N.storage("appData",S))}});let e=await U.getSheets();e.data&&(S.sheets=e.data),k.create(S.proxy),document.body.innerHTML="",document.body.appendChild(k.layout),k.loadTables(S.proxy),k.selectTable(),G(),be=!0}async function ve(){let t=S.proxy.state;if(t.opened&&!t.saved){await ge(!t.saved)==!0&&ve();return}let e=await U.closeWorkbook();if(e.error){X({message:`N\xE3o foi poss\xEDvel fechar o arquivo temp.xls(x)<br>${e.error}`}).show();return}if(e=await U.newFile({minimizeWindow:()=>Neutralino.window.minimize()}),await Neutralino.window.unminimize(),!e.canceled){if(e.error){X({message:`Falha ao criar o arquivo.<br>${e.error}`}).show();return}S.srvConfig=e.data,ye()}}async function Ze(){let t=S.proxy.state;if(t.opened&&!t.saved){await ge(!0)==!0&&ve();return}let e=await N.showFileDialog({target:"open",title:"Abrir",filters:[{name:"Survey",extensions:["srv"]}]});if(e.canceled)return e;let l=e.data[0];if(e=await U.closeWorkbook(),e.error){X({message:`N\xE3o foi poss\xEDvel fechar o arquivo temp.xls(x)<br>${e.error}`}).show();return}if(await Neutralino.window.minimize(),e=await U.openFile(l),await Neutralino.window.unminimize(),e.error){X({message:`Falha ao abrir o arquivo.<br>${e.error}`}).show();return}S.srvConfig=e.data,S.state.opened=!0,S.state.saved=!0,ye()}async function ge(t=!1){let e=S.proxy.srvFileName;if(t)return new Promise(async h=>{Y({title:"Survey",content:`Deseja salvar as altera\xE7\xF5es em ${e}?`,hideOut:!1,buttons:[{name:"Savar",primary:!0,onClick:async c=>{c.hide();let p=await l();h(p)}},{name:"N\xE3o salvar",onClick:c=>{c.hide(),h(!1)}},{name:"Cancelar",onClick:c=>{c.hide(),h("canceled")}}]}).show()});return l();async function l(){let h=await U.saveFile(S.srvConfig);return h.error?(Y({title:"Survey",content:`Falha ao salvar ${e}<br>${h.error}`,buttons:[{name:"OK",onClick:c=>c.hide()}]}).show(),"error"):(S.proxy.state.saved=!0,!0)}}function Qe(){let t=Y({title:"Informa\xE7\xF5es do arquivo",content:"Informa\xE7\xF5es do arquivo.",width:360,hideOut:!0,buttons:[{name:"OK",primary:!0,onClick:()=>t.hide()}]});t.show()}})();
